<!doctype html>
<html lang="en" class="h-100">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <title>Prenotazione</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/sticky-footer-navbar/">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    <link href="sticky-footer-navbar.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }

        .container {
            padding: 2rem 0rem;
        }

        @media (min-width: 576px){
            .modal-dialog {
                max-width: 300px;
            }
            .modal-content {
                padding: 1rem;
            }
        }

        .modal-header .close {
            margin-top: -1.5rem;
        }


        .form-title {
            margin: -2rem 0rem 2rem;
        }

        .btn-round {
            border-radius: 3rem;
        }

        footer {
            background-color: #555;
            color: white;
            padding: 15px;
        }
    </style>


    <!-- LOGIN E STAMPA STATO NEL FOOTER -->

    <script>

        $(document).ready(function () {
            $("#go").click(function () {
                var n = document.getElementById("utente").value;
                var m = document.getElementById("password").value;
                $.post("Servlet02", {utente: n, password: m},
                    function (data) {
                        $("#saluto").html(data);
                    });
            });
        });


   // <!-- AGGIUNTA DOCENTE CON CONFERMA-->


        $(document).ready(function () {
            $("#AddDoc").click(function () {
                var nome = document.getElementById("dname").value;
                var cognome = document.getElementById("lname").value;
                var iddocente = document.getElementById("idDoc").value;
                $.post("ServletAddDoc", {dname: nome, lname: cognome, idDoc: iddocente},
                    function (data) {
                        $("#ADDEDDOC").html("Docente Aggiunto con successo");
                    });
            });
        });

  //  <!-- AGGIUNTA CORSO CON CONFERMA-->

        $(document).ready(function () {
            $("#AddCor").click(function () {
                var idInsegnamento = document.getElementById("idInsegnamento").value;
                var idDocenteC = document.getElementById("idDocenteC").value;
                var idCorso = document.getElementById("idCorso").value;
                $.post("ServletAddCorso", {idInsegnamento: idInsegnamento, idDocenteC: idDocenteC, idCorso: idCorso},
                    function (data) {
                        $("#ADDEDCORSO").html("Docente Aggiunto con successo");
                    });
            });
        });

    </script>

</head>
<body class="d-flex flex-column h-100">
<div id="app">
    <nav class="navbar navbar-expand-lg navbar-light bg-dark">
        <div class="container-fluid">


            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                </ul>
                <!-- LOGIN E LOGOUT -->
                {{ login }}
                <button type="button" v-show="!autorizzazione" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#exampleModal">Login</button>
                <span v-show="autorizzazione">
                        <button type="button" v-on:click="autorizzazione=false, admin=false, utente=false" id="logoutt" class="btn btn-outline-success" data-bs-toggle="modal" data-bs-target="#exampleModal">Logout</button>
                    </span>

                <!-- LOGOUT CON CONFERMA NEL FOOTER -->

                <script type="text/javascript">
                    $(document).ready(function () {
                        $("#logoutt").click(function () {

                            $.post("ServletLogout",
                                function (data) {
                                    var auto = this;
                                    auto.autorizzazione = false;
                                    $("#VisUtentii").html(data);
                                });
                        });
                    });
                </script>

                <!-- MENU DI LOGIN CON USER E PASS -->
                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <!-- FORM DI UTENTE E PASSWORD -->
                            <div class="modal-body">
                                <div class="d-flex justify-content-center">
                                    <img src="utente.png" height="50" width="50"/>
                                </div>
                                <form>
                                    <div class="mb-3">
                                        <input id="utente" type="text" class="form-control" name="utente" placeholder="Utente" required>
                                    </div>
                                    <div class="mb-3">
                                        <input id="password" type="password" class="form-control" name="password" placeholder="Password" required>
                                    </div>
                                    <button type="button" v-on:click="getInfo" id="go" class="btn btn-outline-success" data-bs-dismiss="modal" >Login</button> <br><br>

                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- SIDENAV CON MAIN -->
    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <!-- COMANDI UTENTI E ADMIN -->
                <div class="position-sticky pt-3">
                    <span v-show="admin"> <p>
                     <button type="button" v-on:click="getUtente" id="getUtente"  >Visualizza Utenti</button> <br><br>
                     <button type="button" v-on:click="getPrenotazione" id="getPrenotazioni"  >Prenotazioni </button> <br><br>
                     <button type="button" v-on:click="AddDocente = true" id="addDocente"  >Aggiungi Docente</button> <br><br>
                     <button type="button" id="removeDocente" >Rimuovi Docente</button> <br><br>
                     <button type="button" v-on:click="AddCorso = true" id="addCorso" >Aggiungi Corso</button> <br><br>
                     <button type="button" id="removeCorso"  >Rimuovi Corso</button> <br><br>
                </p>


                <span v-show="AddDocente">
                    <label for="dname">Nome</label> <br>
                    <input type="text" id="dname" name="dname"> <br>
                    <label for="lname">Cognome</label> <br>
                    <input type="text" id="lname" name="lname"> <br>
                    <label for="idDoc">idDocente</label> <br>
                    <input type="text" id="idDoc" name="idDoc"> <br><br>

                    <p><input type="submit" v-on:click="AddDocente" id="AddDoc" name="submit" value="INSERISCI DOCENTE"/></p> <br>
                </span>

                    <span v-show="AddCorso">
                    <label for="idInsegnamento">Insegnamento</label> <br>
                    <input type="text" id="idInsegnamento" name="idInsegnamento"> <br>
                    <label for="idDocenteC">Docente</label> <br>
                    <input type="text" id="idDocenteC" name="idDocenteC"> <br>
                    <label for="idCorso">Corso</label> <br>
                    <input type="text" id="idCorso" name="idCorso"> <br><br>

                    <p><input type="submit" v-on:click="AddCorso" id="AddCor" name="submit" value="INSERISCI CORSO"/></p> <br>
                </span>

                     <di v-for="prenotazione in prenotazioni"><p>{{prenotazione.idPrenotazione}} {{prenotazione.idUtente}} {{prenotazione.idDocente}} {{prenotazione.idCorso}} {{prenotazione.orario}} {{prenotazione.data}}</p></di>

                     <di v-for="utente in utenti"><p>{{utente.nome}} {{utente.cognome}} {{utente.nomeUtente}} {{utente.password}} {{utente.ruolo}}</p></di>


                </span>


                </div>
            </nav>
            <!-- MAIN CON CALENDARIO -->

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    Calendario Lezioni
                </div>

                <canvas class="my-4 w-100" id="myChart" width="900" height="380"></canvas>
            </main>

        </div>
    </div>
    <!-- FOOTER PER STAMPE -->

    <footer class="footer mt-auto py-3 bg-dark text-center">
        <span v-show="autorizzazione"><div id="saluto" class="outputTextArea"></div> </span>
        <span v-show="!autorizzazione">  <div id="VisUtentii" class="outputTextArea"></div> </span>
        <span v-show="AddDocente">  <div id="ADDEDDOC" class="outputTextArea"></div> </span>
        <span v-show="AddCorso">  <div id="ADDEDCORSO" class="outputTextArea"></div> </span>
    </footer>


</div>

<script>
    var app = new Vue ({
        el: '#app',
        data: {
            login: ' ',
            autori: 'prova',
            autorizzazione: false,
            utente: false,
            admin: false,
            AddDocente: false,
            utenti : [],
            prenotazioni : [],
            AddCorso : false,
            link :  '/Ripetizioni/Servlet02',
            link1 : '/Ripetizioni/ServletJSON',
            link2 : '/Ripetizioni/ServletPrenotazioni',
        },

        methods:{
            getInfo:function(){
                var auto = this;
                $.post(this.link, {utente:$("#utente").val(), password:$("#password").val()}, function(data) {
                    auto.login = data;
                    if (auto.login.trim() === "Admin") {
                        auto.autorizzazione = true;
                        auto.utente = true;
                        auto.admin = true;
                        auto.login = "Benvenuto/a";
                    } else if (auto.login.trim() === "Utente") {
                        auto.autorizzazione = true;
                        auto.utente = true;
                        auto.admin = false;
                        auto.login = "Benvenuto/a";
                    } else if (auto.login.trim() === "Nonloggato") {
                        auto.autorizzazione = false;
                        auto.utente = false;
                        auto.admin = false;
                        auto.login = "Utente o password errato";
                    }
                });
            },

            getUtente: function () {
                var self = this;
                $.get(this.link1, function (data2) {
                    self.utenti = data2;
                });
            },

            getPrenotazione: function () {
                var self1 = this;
                $.get(this.link2, function (data3) {
                    self1.prenotazioni = data3;
                });
            },


        }
    });

</script>
</body>
</html>
